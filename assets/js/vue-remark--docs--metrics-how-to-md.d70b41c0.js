(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{241:function(t,e,a){"use strict";e.a={name:"VueRemarkRoot",render:function(t){return t("div",null,this.$slots.default)}}},309:function(t,e,a){"use strict";a.r(e);var n=a(9),r=a(241),s=a(0);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}s.a.config.optionMergeStrategies;var p={VueRemarkRoot:r.a},i=function(t){var e=t.options.components=t.options.components||{},a=t.options.computed=t.options.computed||{};Object.keys(p).forEach((function(t){"object"===o(p[t])&&"function"==typeof p[t].render?e[t]=p[t]:a[t]=function(){return p[t]}}))},c=s.a.config.optionMergeStrategies,l="__vueRemarkFrontMatter",u={excerpt:null,title:"Accessing Metrics",topic:"metrics",type:"how-to"};var v=function(t){t.options[l]&&(t.options[l]=u),s.a.util.defineReactive(t.options,l,u),t.options.computed=c.computed({$frontmatter:function(){return t.options[l]}},t.options.computed)},_=Object(n.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("VueRemarkRoot",[a("h1",{attrs:{id:"accessing-metrics"}},[a("a",{attrs:{href:"#accessing-metrics","aria-hidden":"true"}},[t._v("#")]),t._v("Accessing Metrics")]),a("h2",{attrs:{id:"overview"}},[a("a",{attrs:{href:"#overview","aria-hidden":"true"}},[t._v("#")]),t._v("Overview")]),a("p",[t._v("Working Group Two exposes metrics to that can help operators getting some operational insight.\nThis is exposed in the "),a("a",{attrs:{href:"https://openmetrics.io/",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("Open Metrics text format")]),t._v("  ("),a("a",{attrs:{href:"https://prometheus.io/docs/instrumenting/exposition_formats/#text-based-format",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("details")]),t._v(").")]),a("p",[t._v("We do support this by exposing a custom Prometheus instance, containing relevant time series.\nAs we use Prometheus, metrics fetching is pull based.")]),a("p",[t._v("Please reach out to clarify needs and setup of this instance.")]),a("h2",{attrs:{id:"tokencredentials"}},[a("a",{attrs:{href:"#tokencredentials","aria-hidden":"true"}},[t._v("#")]),t._v("Token/credentials")]),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://console.wgtwo.com/api-keys-redirect",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("Get credentials from Console")])]),a("p",[t._v("Required right: "),a("code",{pre:!0},[t._v("metrics.prometheus.read")])])])]),a("h2",{attrs:{id:"configuration"}},[a("a",{attrs:{href:"#configuration","aria-hidden":"true"}},[t._v("#")]),t._v("Configuration")]),a("p",[t._v("Replace "),a("code",{pre:!0},[t._v("{{id}}")]),t._v(", "),a("code",{pre:!0},[t._v("{{client ID}}")]),t._v(" and "),a("code",{pre:!0},[t._v("{{client secret}}")]),t._v(" with their actual values")]),a("table",[a("thead",[a("tr",[a("th",{attrs:{align:"left"}},[t._v("Placeholder")]),a("th",{attrs:{align:"left"}},[t._v("Description")])])]),a("tbody",[a("tr",[a("td",{attrs:{align:"left"}},[a("code",{pre:!0},[t._v("{{id}}")])]),a("td",{attrs:{align:"left"}},[t._v("Identifier provided by Working Group Two")])]),a("tr",[a("td",{attrs:{align:"left"}},[a("code",{pre:!0},[t._v("{{client ID}}")])]),a("td",{attrs:{align:"left"}},[t._v("From credentials created in Console")])]),a("tr",[a("td",{attrs:{align:"left"}},[a("code",{pre:!0},[t._v("{{client secret}}")])]),a("td",{attrs:{align:"left"}},[t._v("From credentials created in Console")])])])]),a("p",[a("strong",[t._v("Base path: "),a("code",{pre:!0},[t._v("https://api.wgtwo.com/metrics/v1/prometheus/{{id}}")])])]),a("h3",{attrs:{id:"invoke-health-check-to-test-credentials"}},[a("a",{attrs:{href:"#invoke-health-check-to-test-credentials","aria-hidden":"true"}},[t._v("#")]),t._v("Invoke health check to test credentials")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",{pre:!0,attrs:{class:"language-bash"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -u "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("client ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("client secret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" https://api.wgtwo.com/metrics/v1/prometheus/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("/-/healthy")])]),a("h3",{attrs:{id:"configure-prometheus-federation"}},[a("a",{attrs:{href:"#configure-prometheus-federation","aria-hidden":"true"}},[t._v("#")]),t._v("Configure Prometheus federation")]),a("p",[t._v("If you already run Prometheus or would like to control data retention, doing federation from our Prometheus can be a\ngood choice.")]),a("p",[t._v("The below Prometheus config will scrape your custom Prometheus instance at Working Group Two every 30 seconds,\nfetching all available time series. Note that the configuration will contain secrets.")]),a("p",[t._v("See: "),a("a",{attrs:{href:"https://prometheus.io/docs/prometheus/latest/federation/",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("prometheus.io › Federation")])]),a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",{pre:!0,attrs:{class:"language-yaml"}},[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("global")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("     30s\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("evaluation_interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 30s\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_configs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("job_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'federate'")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("honor_labels")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metrics_path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/metrics/v1/prometheus/{{id}}/federate'")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scheme")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" https\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("basic_auth")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{{client ID}}'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{{client secret}}'")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("params")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    'match"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{__name__=~\".+\"}'")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("static_configs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'api.wgtwo.com:443'")])])]),a("h4",{attrs:{id:"example-run-with-docker"}},[a("a",{attrs:{href:"#example-run-with-docker","aria-hidden":"true"}},[t._v("#")]),t._v("Example: Run with Docker")]),a("p",[t._v("See: "),a("a",{attrs:{href:"https://prometheus.io/docs/prometheus/latest/installation/#using-docker",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("prometheus.io › Using Docker")])]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",{pre:!0,attrs:{class:"language-bash"}},[t._v("docker run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -p "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9090")]),t._v(":9090 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -v /tmp/prometheus.yml:/etc/prometheus/prometheus.yml "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    prom/prometheus")])]),a("p",[t._v("For testing that federation works as expected, you may run this with the above config.")]),a("h3",{attrs:{id:"grafana"}},[a("a",{attrs:{href:"#grafana","aria-hidden":"true"}},[t._v("#")]),t._v("Grafana")]),a("p",[t._v("Grafana has built-in support for Prometheus.")]),a("p",[t._v("It is possible to point your Grafana to api.wgtwo.com directly, which might be a good solution if you do not already\nrun Prometheus and want to get started quickly.")]),a("p",[t._v("See: "),a("a",{attrs:{href:"https://grafana.com/docs/grafana/latest/features/datasources/prometheus/",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("grafana.com › Using Prometheus in Grafana")])]),a("h2",{attrs:{id:"links"}},[a("a",{attrs:{href:"#links","aria-hidden":"true"}},[t._v("#")]),t._v("Links")]),a("ul",[a("li",[a("a",{attrs:{href:"https://openmetrics.io/",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("openmetrics.io")])]),a("li",[a("a",{attrs:{href:"https://prometheus.io/docs/instrumenting/exposition_formats/#text-based-format",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("prometheus.io › Exposition Formats")])])])])}),[],!1,null,null,null);"function"==typeof i&&i(_),"function"==typeof v&&v(_);e.default=_.exports}}]);